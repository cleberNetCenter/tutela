<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸ” DEBUG MOBILE DROPDOWN - ANÃLISE COMPLETA</title>
  
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Courier New', monospace;
      background: #0a0a0a;
      color: #00ff00;
      padding: 10px;
      font-size: 12px;
      line-height: 1.4;
    }
    
    #debug-output {
      white-space: pre-wrap;
      word-break: break-all;
    }
    
    .error { color: #ff0000; }
    .success { color: #00ff00; }
    .warning { color: #ffaa00; }
    .info { color: #00aaff; }
    
    button {
      background: #00ff00;
      color: #000;
      border: none;
      padding: 15px 20px;
      margin: 10px 5px;
      font-weight: bold;
      font-size: 14px;
      cursor: pointer;
      border-radius: 5px;
      width: calc(50% - 12px);
    }
    
    button:active {
      background: #00cc00;
    }
    
    .test-section {
      border: 2px solid #00ff00;
      margin: 10px 0;
      padding: 10px;
      border-radius: 5px;
    }
  </style>
</head>
<body>
  <h1>ğŸ” DEBUG MOBILE DROPDOWN</h1>
  <p>Este debug irÃ¡ identificar EXATAMENTE o que impede os dropdowns de funcionar</p>
  
  <div style="margin: 20px 0;">
    <button onclick="runFullDiagnostic()">â–¶ï¸ DIAGNÃ“STICO COMPLETO</button>
    <button onclick="clearOutput()">ğŸ§¹ LIMPAR</button>
  </div>
  
  <div id="debug-output"></div>

  <script>
    const output = document.getElementById('debug-output');
    
    function log(message, type = 'info') {
      const timestamp = new Date().toLocaleTimeString();
      const line = document.createElement('div');
      line.className = type;
      line.textContent = `[${timestamp}] ${message}`;
      output.appendChild(line);
      console.log(`[${type.toUpperCase()}] ${message}`);
    }
    
    function clearOutput() {
      output.innerHTML = '';
      console.clear();
      log('Console limpo', 'info');
    }
    
    async function runFullDiagnostic() {
      clearOutput();
      log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•', 'info');
      log('ğŸ” INICIANDO DIAGNÃ“STICO COMPLETO DO DROPDOWN MOBILE', 'success');
      log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•', 'info');
      log('', 'info');
      
      // ========== TESTE 1: VIEWPORT ==========
      log('â”â”â” TESTE 1: VIEWPORT E DIMENSÃ•ES â”â”â”', 'info');
      log(`Window Width: ${window.innerWidth}px`, 'info');
      log(`Window Height: ${window.innerHeight}px`, 'info');
      log(`Device Pixel Ratio: ${window.devicePixelRatio}`, 'info');
      log(`User Agent: ${navigator.userAgent}`, 'info');
      
      const isMobileWidth = window.innerWidth <= 1200;
      if (isMobileWidth) {
        log('âœ… Largura Ã© mobile (â‰¤1200px)', 'success');
      } else {
        log('âŒ PROBLEMA: Largura Ã© desktop (>1200px)', 'error');
        log('ğŸ’¡ SOLUÃ‡ÃƒO: Ative o modo mobile no DevTools (Ctrl+Shift+M)', 'warning');
      }
      log('', 'info');
      
      // ========== TESTE 2: ARQUIVOS CSS ==========
      log('â”â”â” TESTE 2: ARQUIVOS CSS CARREGADOS â”â”â”', 'info');
      const stylesheets = Array.from(document.styleSheets);
      log(`Total de stylesheets: ${stylesheets.length}`, 'info');
      
      const requiredCSS = [
        'dropdown-menu.css',
        'styles-header-final.css'
      ];
      
      for (const required of requiredCSS) {
        const found = stylesheets.some(sheet => 
          sheet.href && sheet.href.includes(required)
        );
        if (found) {
          log(`âœ… ${required} carregado`, 'success');
        } else {
          log(`âŒ ${required} NÃƒO carregado`, 'error');
        }
      }
      log('', 'info');
      
      // ========== TESTE 3: ARQUIVOS JS ==========
      log('â”â”â” TESTE 3: ARQUIVOS JAVASCRIPT â”â”â”', 'info');
      const scripts = Array.from(document.querySelectorAll('script[src]'));
      log(`Total de scripts externos: ${scripts.length}`, 'info');
      
      const requiredJS = [
        'dropdown-menu.js',
        'mobile-menu.js'
      ];
      
      for (const required of requiredJS) {
        const found = scripts.some(script => 
          script.src.includes(required)
        );
        if (found) {
          log(`âœ… ${required} incluÃ­do`, 'success');
        } else {
          log(`âŒ ${required} NÃƒO incluÃ­do`, 'error');
        }
      }
      log('', 'info');
      
      // ========== TESTE 4: ELEMENTOS HTML ==========
      log('â”â”â” TESTE 4: ESTRUTURA HTML â”â”â”', 'info');
      
      const nav = document.getElementById('nav');
      if (nav) {
        log(`âœ… #nav encontrado`, 'success');
        log(`   Classes: ${nav.className || '(nenhuma)'}`, 'info');
        log(`   Display: ${window.getComputedStyle(nav).display}`, 'info');
        log(`   Visibility: ${window.getComputedStyle(nav).visibility}`, 'info');
        log(`   Position: ${window.getComputedStyle(nav).position}`, 'info');
      } else {
        log(`âŒ #nav NÃƒO encontrado`, 'error');
      }
      
      const mobileBtn = document.querySelector('.mobile-menu-btn');
      if (mobileBtn) {
        log(`âœ… .mobile-menu-btn encontrado`, 'success');
        log(`   Display: ${window.getComputedStyle(mobileBtn).display}`, 'info');
      } else {
        log(`âŒ .mobile-menu-btn NÃƒO encontrado`, 'error');
      }
      
      const dropdowns = document.querySelectorAll('.nav-dropdown');
      log(`Dropdowns encontrados: ${dropdowns.length}`, 'info');
      
      dropdowns.forEach((dropdown, i) => {
        log(``, 'info');
        log(`  Dropdown ${i + 1}:`, 'info');
        
        const toggle = dropdown.querySelector('.nav-link');
        if (toggle) {
          log(`    âœ… Toggle encontrado: "${toggle.textContent.trim()}"`, 'success');
        } else {
          log(`    âŒ Toggle (.nav-link) NÃƒO encontrado`, 'error');
        }
        
        const menu = dropdown.querySelector('.dropdown-menu');
        if (menu) {
          log(`    âœ… Menu encontrado`, 'success');
          log(`       Display: ${window.getComputedStyle(menu).display}`, 'info');
          log(`       Visibility: ${window.getComputedStyle(menu).visibility}`, 'info');
          const links = menu.querySelectorAll('a');
          log(`       Links: ${links.length}`, 'info');
        } else {
          log(`    âŒ Menu (.dropdown-menu) NÃƒO encontrado`, 'error');
        }
      });
      log('', 'info');
      
      // ========== TESTE 5: EVENT LISTENERS ==========
      log('â”â”â” TESTE 5: EVENT LISTENERS â”â”â”', 'info');
      
      if (dropdowns.length > 0) {
        log('Testando se event listeners funcionam...', 'info');
        
        // Adicionar listener de teste
        let clickDetected = false;
        const testDropdown = dropdowns[0];
        const testToggle = testDropdown.querySelector('.nav-link');
        
        if (testToggle) {
          const testListener = (e) => {
            clickDetected = true;
            log('âœ… Click detectado no toggle!', 'success');
            log(`   Target: ${e.target.tagName}`, 'info');
            log(`   CurrentTarget: ${e.currentTarget.tagName}`, 'info');
            testToggle.removeEventListener('click', testListener);
          };
          
          testToggle.addEventListener('click', testListener);
          
          // Simular click
          testToggle.click();
          
          await new Promise(resolve => setTimeout(resolve, 100));
          
          if (clickDetected) {
            log('âœ… Event listener FUNCIONANDO', 'success');
          } else {
            log('âŒ Event listener NÃƒO respondeu', 'error');
          }
        } else {
          log('âš ï¸ NÃ£o foi possÃ­vel testar (toggle nÃ£o encontrado)', 'warning');
        }
      }
      log('', 'info');
      
      // ========== TESTE 6: CSS RULES ==========
      log('â”â”â” TESTE 6: REGRAS CSS MOBILE â”â”â”', 'info');
      
      // Verificar se regras mobile existem
      let foundMobileMediaQuery = false;
      let foundNavActive = false;
      let foundDropdownActive = false;
      
      for (const sheet of stylesheets) {
        try {
          const rules = sheet.cssRules || sheet.rules;
          if (!rules) continue;
          
          for (const rule of rules) {
            if (rule.media && rule.media.mediaText.includes('max-width: 1200px')) {
              foundMobileMediaQuery = true;
              
              // Procurar dentro da media query
              const innerRules = rule.cssRules || [];
              for (const innerRule of innerRules) {
                if (innerRule.selectorText) {
                  if (innerRule.selectorText.includes('.nav.active')) {
                    foundNavActive = true;
                  }
                  if (innerRule.selectorText.includes('.nav-dropdown.active')) {
                    foundDropdownActive = true;
                  }
                }
              }
            }
          }
        } catch (e) {
          // CORS pode bloquear acesso a stylesheet externo
          log(`âš ï¸ NÃ£o foi possÃ­vel acessar stylesheet (CORS): ${sheet.href}`, 'warning');
        }
      }
      
      if (foundMobileMediaQuery) {
        log('âœ… Media query mobile (@media max-width: 1200px) encontrada', 'success');
      } else {
        log('âŒ Media query mobile NÃƒO encontrada', 'error');
      }
      
      if (foundNavActive) {
        log('âœ… Regra .nav.active encontrada', 'success');
      } else {
        log('âš ï¸ Regra .nav.active nÃ£o detectada (pode ser CORS)', 'warning');
      }
      
      if (foundDropdownActive) {
        log('âœ… Regra .nav-dropdown.active encontrada', 'success');
      } else {
        log('âš ï¸ Regra .nav-dropdown.active nÃ£o detectada (pode ser CORS)', 'warning');
      }
      log('', 'info');
      
      // ========== TESTE 7: FUNÃ‡ÃƒO toggleMobileMenu ==========
      log('â”â”â” TESTE 7: FUNÃ‡ÃƒO toggleMobileMenu â”â”â”', 'info');
      
      if (typeof toggleMobileMenu === 'function') {
        log('âœ… toggleMobileMenu estÃ¡ definida', 'success');
        
        // Testar a funÃ§Ã£o
        try {
          log('Chamando toggleMobileMenu()...', 'info');
          toggleMobileMenu();
          
          await new Promise(resolve => setTimeout(resolve, 100));
          
          if (nav && nav.classList.contains('active')) {
            log('âœ… toggleMobileMenu FUNCIONOU (nav.active = true)', 'success');
            
            // Fechar novamente
            toggleMobileMenu();
          } else {
            log('âŒ toggleMobileMenu NÃƒO adicionou .active ao #nav', 'error');
          }
        } catch (e) {
          log(`âŒ Erro ao chamar toggleMobileMenu: ${e.message}`, 'error');
        }
      } else {
        log('âŒ toggleMobileMenu NÃƒO estÃ¡ definida', 'error');
        log('ğŸ’¡ PROBLEMA: mobile-menu.js nÃ£o foi carregado ou executado', 'warning');
      }
      log('', 'info');
      
      // ========== TESTE 8: CONSOLE ERRORS ==========
      log('â”â”â” TESTE 8: ERROS NO CONSOLE â”â”â”', 'info');
      
      // Capturar erros futuros
      const originalError = console.error;
      const errors = [];
      console.error = function(...args) {
        errors.push(args.join(' '));
        originalError.apply(console, args);
      };
      
      log('Monitorando console.error...', 'info');
      log('(Verifique o console do navegador para erros completos)', 'warning');
      log('', 'info');
      
      // ========== TESTE 9: SIMULAÃ‡ÃƒO DE CLICK ==========
      log('â”â”â” TESTE 9: SIMULAÃ‡ÃƒO DE CLICKS â”â”â”', 'info');
      
      if (mobileBtn && nav) {
        log('Simulando click no botÃ£o mobile...', 'info');
        mobileBtn.click();
        
        await new Promise(resolve => setTimeout(resolve, 300));
        
        const navIsActive = nav.classList.contains('active');
        log(`Estado #nav.active: ${navIsActive}`, navIsActive ? 'success' : 'error');
        
        if (navIsActive) {
          log('âœ… Menu mobile ABRIU', 'success');
          
          // Testar dropdown
          if (dropdowns.length > 0) {
            const firstDropdown = dropdowns[0];
            const firstToggle = firstDropdown.querySelector('.nav-link');
            
            if (firstToggle) {
              log('', 'info');
              log('Simulando click no primeiro dropdown...', 'info');
              firstToggle.click();
              
              await new Promise(resolve => setTimeout(resolve, 300));
              
              const dropdownIsActive = firstDropdown.classList.contains('active');
              log(`Estado .nav-dropdown.active: ${dropdownIsActive}`, dropdownIsActive ? 'success' : 'error');
              
              if (dropdownIsActive) {
                log('âœ… Dropdown ABRIU', 'success');
                
                // Verificar display
                const menu = firstDropdown.querySelector('.dropdown-menu');
                if (menu) {
                  const display = window.getComputedStyle(menu).display;
                  log(`Display do menu: ${display}`, display === 'flex' ? 'success' : 'error');
                  
                  if (display === 'flex') {
                    log('âœ… Menu estÃ¡ VISÃVEL (display: flex)', 'success');
                  } else {
                    log(`âŒ Menu NÃƒO estÃ¡ visÃ­vel (display: ${display})`, 'error');
                    log('ğŸ’¡ PROBLEMA: CSS nÃ£o estÃ¡ aplicando display: flex', 'warning');
                  }
                }
              } else {
                log('âŒ Dropdown NÃƒO abriu', 'error');
                log('ğŸ’¡ PROBLEMA: JavaScript nÃ£o estÃ¡ adicionando .active', 'warning');
              }
            }
          }
        } else {
          log('âŒ Menu mobile NÃƒO abriu', 'error');
          log('ğŸ’¡ PROBLEMA: toggleMobileMenu nÃ£o estÃ¡ funcionando', 'warning');
        }
      } else {
        log('âš ï¸ NÃ£o foi possÃ­vel testar (botÃ£o ou nav nÃ£o encontrado)', 'warning');
      }
      log('', 'info');
      
      // ========== RESUMO FINAL ==========
      log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•', 'info');
      log('ğŸ“Š RESUMO DO DIAGNÃ“STICO', 'info');
      log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•', 'info');
      
      const issues = [];
      
      if (!isMobileWidth) issues.push('Viewport nÃ£o estÃ¡ em modo mobile');
      if (!document.querySelector('link[href*="dropdown-menu.css"]')) issues.push('CSS dropdown-menu.css nÃ£o carregado');
      if (!document.querySelector('script[src*="dropdown-menu.js"]')) issues.push('JS dropdown-menu.js nÃ£o incluÃ­do');
      if (!document.querySelector('script[src*="mobile-menu.js"]')) issues.push('JS mobile-menu.js nÃ£o incluÃ­do');
      if (!nav) issues.push('Elemento #nav nÃ£o encontrado');
      if (!mobileBtn) issues.push('BotÃ£o .mobile-menu-btn nÃ£o encontrado');
      if (dropdowns.length === 0) issues.push('Nenhum .nav-dropdown encontrado');
      if (typeof toggleMobileMenu !== 'function') issues.push('FunÃ§Ã£o toggleMobileMenu nÃ£o definida');
      
      if (issues.length === 0) {
        log('âœ… NENHUM PROBLEMA CRÃTICO DETECTADO', 'success');
        log('', 'info');
        log('ğŸ’¡ Se ainda nÃ£o funciona, verifique:', 'warning');
        log('   1. Limpe o cache do navegador (Ctrl+Shift+Del)', 'warning');
        log('   2. FaÃ§a hard refresh (Ctrl+Shift+F5)', 'warning');
        log('   3. Verifique o console do navegador para erros', 'warning');
        log('   4. Teste em aba anÃ´nima', 'warning');
      } else {
        log(`âŒ ${issues.length} PROBLEMA(S) ENCONTRADO(S):`, 'error');
        log('', 'info');
        issues.forEach((issue, i) => {
          log(`   ${i + 1}. ${issue}`, 'error');
        });
        log('', 'info');
        log('ğŸ”§ PRÃ“XIMOS PASSOS:', 'warning');
        log('   1. Corrija os problemas listados acima', 'warning');
        log('   2. Execute o diagnÃ³stico novamente', 'warning');
        log('   3. Verifique os arquivos CSS/JS estÃ£o no caminho correto', 'warning');
      }
      
      log('', 'info');
      log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•', 'info');
      log('ğŸ” DIAGNÃ“STICO COMPLETO FINALIZADO', 'success');
      log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•', 'info');
    }
    
    // Auto-executar ao carregar
    window.addEventListener('load', () => {
      setTimeout(() => {
        log('PÃ¡gina carregada. Clique em "DIAGNÃ“STICO COMPLETO" para iniciar.', 'info');
      }, 500);
    });
  </script>
</body>
</html>
